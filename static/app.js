$(function(){function n(n){var e=n.xAxisExtremes(),t=e.shift(),i=e.shift();(!r||r>t)&&(r=t),(!a||i>a)&&(a=i)}function e(n){var e=["component","timezone"],t=[],i=n.series[0];_.each(i.columns,function(n,i){_.contains(e,n)&&t.push(i)}),t=t.reverse(),_.each(t,function(n){i.columns.splice(n,1)}),_.each(i.values,function(n){_.each(t,function(e){n.splice(e,1)})})}function t(n){var e=[],t=n.series[0],i=t.columns,o=t.values;return e.push(i),_.each(o,function(n){e.push(n.join(","))}),e.join("\n")}function i(n,i){var o=document.getElementById(n);e(i);var r=t(i),a=$("#"+n+"-container").width();return new Dygraph(o,r,{width:a,height:400,series:{value:{strokeWidth:2,strokePattern:[4,1]},anomalyScore:{axis:"y2",color:"orange"},anomalyLikelihood:{axis:"y2",color:"red"}},axes:{y2:{valueRange:[0,1.1]}},legend:"follow",labelsSeparateLines:!0})}function o(n,e){return i(n,e)}var r,a,c=($("#chart-container"),[]),s=2e3,l=5e3;$.getJSON("/_data/sensors",function(e){var t=l,i=window.STHTMB.utils.getUrlVars();void 0!==i.limit?t=i.limit:window.location.href.indexOf("/charts")>-1&&(t=s),_.each(e,function(i){var s="/_data/sensor/"+i+"?limit="+t,l=i.replace("/","_").replace(/\+/g,"-");document.getElementById(l)&&$.getJSON(s,function(t){var i=o(l,t);n(i),c.push(i),c.length==e.length&&_.each(c,function(n){n.updateOptions({dateWindow:[r,a]})})})})})}),$(function(){function n(){var n=window.location.href.indexOf("?"),e="";return n>1&&(e=window.location.href.slice(window.location.href.indexOf("?")+1)),e}function e(){for(var e,t=[],i=n().split("&"),o=0;o<i.length;o++)e=i[o].split("="),t.push(e[0]),t[e[0]]=e[1];return t}window.STHTMB={utils:{getUrlQueryString:n,getUrlVars:e}}});